<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dragones & Camejos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <img src="/frontend/dragon.png" class="rounded float-end" width="50" right="10" alt="No cargo la imagen">
</head>

<body data-bs-theme="dark">
    <div class="container">
        <div class="row">
            <div class="col">
                <h1>Dragones & Camejos</h1>
                <h5 id="tu_comida">Tu comida: </h5>
                <a href="crear_dragon/" class="btn btn-primary mb-3" style="width: 70%;">Crear Dragon</a>
                <a class="btn btn-secondary mb-3" href="../" style="width: 29%;">Volver</a>
            </div>
        </div>
    </div>

    <div class="container text-center">
        <div class="row row-cols-auto" id="dragones">
          
            <div class="border rounded py-3 px-4 mb-2 mx-1">

                <div id="3" class="col">
                    <div class="row">
                        <img class="img-thumbnail" src="../assets/fuego.png" style="height:200px">
                    </div>
                    <div class="row">
                        <h5 class="mt-2">Carlos</h5>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h5>Hambre</h5>
                        </div>
                        <div class="col">
                            <h5>valor</h5>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h5>Salud</h5>
                        </div>
                        <div class="col">
                            <h5>valor</h5>
                        </div>
                    </div>
                    <div class="row">
                        <button class="btn btn-success d-block p-3">alimentar</button>
                    </div>
                </div>
            </div>

            <div class="border rounded py-3 px-4 mb-2 mx-1">

                <div id="3" class="col">
                    <div class="row">
                        <img class="img-thumbnail" src="../assets/fuego.png" style="height:200px">
                    </div>
                    <div class="row">
                        <h5 class="mt-2">Carlos</h5>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h5>Hambre</h5>
                        </div>
                        <div class="col">
                            <h5>valor</h5>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h5>Salud</h5>
                        </div>
                        <div class="col">
                            <h5>valor</h5>
                        </div>
                    </div>
                    <div class="row">
                        <button class="btn btn-success d-block p-3">alimentar</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        
    const URL_API = "http://192.168.0.243:5000"

    function response_received(response) {
        return response.json();
    }
    function request_error(error) {
        console.log("ERROR");
        console.log(error);
    }


    function cargar_dragones(content) {
        dragones = content['dragones'];

        let div_dragones = document.getElementById("dragones");

        dragones.forEach(dragon => {

            let imagen_dragon =  `../assets/${dragon['tipo_dragon']}.png`

            let div_dragon = document.createElement("div");
            div_dragon.id = dragon['id'];
            div_dragon.setAttribute("class", "col");


            let div_row_img = document.createElement("div");
            div_row_img.setAttribute("class", "row");
            let div_col_img = document.createElement("div");
            div_col_img.setAttribute("class", "col");
            let img = document.createElement("img");
            img.setAttribute("class", "img-thumbnail");
            img.setAttribute("src", imagen_dragon);
            img.setAttribute("style", "height:200px");

            div_col_img.appendChild(img);
            div_row_img.appendChild(div_col_img);
            div_dragon.appendChild(div_row_img);

            let div_row_info = document.createElement("div");
            div_row_info.setAttribute("class", "row");

            let div_col_info = document.createElement("div");
            div_col_info.setAttribute("class", "col");

            let h5_nombre = document.createElement("h5");
            h5_nombre.innerText = dragon['nombre'];

            let div_hambre = 

            div_col_info.appendChild(h5_nombre);
            div_row_info.appendChild(div_col_info);
            div_dragon.appendChild(div_row_info);

            //div_dragon.innerText = `${dragon['nombre']} | tipo: ${dragon['tipo_dragon']} | hambre: ${dragon['hambre']} | salud: ${dragon['salud']}`;
            div_dragones.appendChild(div_dragon);
    });
    }

    function cargar_comida(content) {
        cantidad_comida = content['comida'];

        h5_comida = document.getElementById("tu_comida");
        h5_comida.innerText = `Tu comida: ${cantidad_comida}`;
    }

    function actualizar_comida() {
        fetch(`${URL_API}/almacen`)
            .then(response_received)
            .then(cargar_comida)
            .catch(request_error)
    }

    fetch(`${URL_API}/dragones`)
        .then(response_received)
        .then(cargar_dragones)
        .catch(request_error)

    actualizar_comida()

    </script>
</body>

</html>